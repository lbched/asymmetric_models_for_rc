function L = PLTtrllk(x0,yt,ytpm,ytn,n,T)
A1=eye(6);
A1(1,1)=(x0(1));
A1(2,1)=(x0(2));
A1(3,1)=(x0(3));
A1(4,1)=(x0(4));
A1(5,1)=(x0(5));
A1(6,1)=(x0(6));
A1(2,2)=(x0(7));
A1(3,3)=(x0(8));
A1(4,4)=(x0(9));
A1(5,5)=(x0(10));
A1(6,6)=(x0(11));
A2=eye(6);
A2(1,1)=(x0(12));
A2(2,1)=(x0(13));
A2(3,1)=(x0(14));
A2(4,1)=(x0(15));
A2(5,1)=(x0(16));
A2(6,1)=(x0(17));
A2(2,2)=(x0(18));
A2(3,3)=(x0(19));
A2(4,4)=(x0(20));
A2(5,5)=(x0(21));
A2(6,6)=(x0(22));
B=eye(6);
B(1,1)=(x0(23));
B(2,2)=(x0(24));
B(3,3)=(x0(25));
B(4,4)=(x0(26));
B(5,5)=(x0(27));
B(6,6)=(x0(28));
St=PLTtrrec(A1,A2,B,yt,ytpm,ytn,n,T);
L=zeros(T,1);
for j=1:T
d=det(St(:,:,j));
a=trace(St(:,:,j)\yt(:,:,j));
L(j)=-0.5*log(d)-0.5*(a);
end
end